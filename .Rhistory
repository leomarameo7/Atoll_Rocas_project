axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 10, face = "bold"),
legend.text = element_text(size = 10, face = "italic"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(1.2,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata",
"24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.9,
position = position_dodge(1), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(1), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "italic"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata",
"24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.9,
position = position_dodge(1), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(1), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata",
"24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.9,
position = position_dodge(1), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(1), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata",
"24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.5,
position = position_dodge(1), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(1), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata",
"24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.75,
position = position_dodge(0.5), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(0.5), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata",
"24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.75,
position = position_dodge(0.75), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(0.75), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata",
"24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 10), breaks = seq(-40,10,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.75,
position = position_dodge(0.75), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(0.75), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata", "24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 10), breaks = seq(-40,10,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.85,
position = position_dodge(0.75), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(0.75), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 14, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata", "24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
ggsave(p,
file = "outputs_results/supplementary_materials/percent_variation_NOFISH_2100.png",
units = "mm",
width= 233, dpi = 400)
ggsave(p,
file = "outputs_results/supplementary_materials/percent_variation_NOFISH_2100.png",
units = "mm",
width= 233,
height = 174,
dpi = 400)
#### Plot -------
p <-  ggplot(a_2100,
aes(x = species, y = mean_variation, label = numbers)) +
geom_bar(aes(fill=species), width = 0.85,
position = position_dodge(0.75), stat="identity",colour = "black") +
geom_text(aes(y = ifelse(mean_variation < 0, 8, -8), label = numbers),
position = position_dodge(0.75), size = 4) +
# move numbers to the right of the geom_error bar "hjust = -0.25", in the aes() of geom_text
# geom_errorbar(aes(ymin = min_variation, ymax = max_variation),position= position_dodge(width=1),width = 0.1) +
geom_hline(yintercept = 0) +
facet_wrap(~scenario, scales = "free", ncol=1, strip.position = "right") +
theme_bw() +
labs(y = "Relative average biomass change (%)") +
theme(text = element_text(family = "Times New Roman"),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.spacing.y  = unit(1, "lines"),
strip.text.x = element_text(size = 10, color = "black", face = "bold"),
strip.text.y = element_text(size = 10, color = "black", face = "bold"),
axis.line.x = element_line(colour = "white"),
axis.line.y = element_line(colour = "black"),
axis.ticks.x = element_blank(),
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 10, face = "plain"),
legend.position = "bottom",
# plot.title = element_text(hjust= 0.5, vjust=2, size = 10 ,face = "bold"),
legend.key.size = unit(0.75,"line"),
axis.text.x =  element_blank(),
axis.text.y = element_text (size = 14,colour = "black",face = "plain" ),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 16,colour = "black",face = "plain" )) +
scale_fill_manual(values = c("Sea birds"="wheat","Turtles"="wheat",
"Cephalopoda"="wheat", "Panulirus spp."="wheat","Benthic macroinvertebrates"="wheat",
"Benthic microinvertebrates"="wheat","Siderastrea stellata"="wheat","Zooplankton"="wheat",
"Phytoplankton"="wheat", "Digenea simplex"="wheat","Other algal turf"="wheat"),
name = "Species:",
labels = c("1: Sea birds","18:Turtles", "19: Cephalopoda", "20: Panulirus spp.", "21: Benthic macroinvertebrates",
"22: Benthic microinvertebrates", "23: Siderastrea stellata", "24: Zooplankton", "25: Phytoplankton",
"26: Digenea simplex","27: Other algal turf")) +
scale_y_continuous(position = "left",
limits=c(-100,120), breaks=seq(-100,120,20))
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~scenario, scales = "free_y", ncol = 1, strip.position = "right", scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(-40, 20), breaks = seq(-40,20,10))),
scale_override(2, scale_y_continuous(limits  = c(-100, 40), breaks = seq(-100,40,20))),
scale_override(3, scale_y_continuous(limits  = c(-100, 120),  breaks=seq(-100,120,30)))
))
p
ggsave(p,
file = "outputs_results/supplementary_materials/percent_variation_NOFISH_2100.png",
units = "mm",
width= 233,
height = 174,
dpi = 400)
