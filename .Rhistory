o
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
o <- o +
facet_wrap_custom(~species, scales = "free", ncol = 4,nrow=4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(1, 7), breaks=seq(1,7,1))),
scale_override(2, scale_y_continuous(limits  = c(1.2, 2.3), breaks=seq(1.2,2.3,0.25))),
scale_override(3, scale_y_continuous(limits  = c(0.1, 0.8), breaks=seq(0.1,0.8,0.1))),
scale_override(4, scale_y_continuous(limits  = c(1, 11), breaks=seq(1,11,2))),
scale_override(5, scale_y_continuous(limits  = c(7, 11), breaks=seq(7,11,1))),
scale_override(6, scale_y_continuous(limits  = c(0.1, 0.6), breaks=seq(0.1,0.6,0.1))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.3), breaks=seq(0,0.3,0.05))),
scale_override(8, scale_y_continuous(limits  = c(0.25, 2.75), breaks=seq(0.25,2.75,0.5))),
scale_override(9, scale_y_continuous(limits  = c(1, 2), breaks=seq(1,2,0.15))),
scale_override(10, scale_y_continuous(limits  = c(0.1,1.25), breaks=seq(0.1,1.25,0.25))),
scale_override(11, scale_y_continuous(limits  = c(0.3, 3.25), breaks=seq(0.3,3.25,0.5))),
scale_override(12, scale_y_continuous(limits  = c(1.75, 5.5), breaks=seq(1.75,5.5,0.75))),
scale_override(13, scale_y_continuous(limits  = c(0.5, 2), breaks=seq(0.5,2,0.5))),
scale_override(14, scale_y_continuous(limits  = c(0.1, 1), breaks=seq(0.1,1,0.15)))
))
o
### Made plot ####
o <- ggplot(data= mdata) +
aes(x = year) +
geom_line(aes(y = biomass), size = 1) +
geom_point(aes(y = observed_biomass),size=1.25) +
facet_wrap( ~ species, scales = "free") +
labs(x="Year", y= expression(Biomass~""~(g~m^{-2}))) +
theme(text=element_text(family="Times New Roman"),
strip.text.x = element_text(size = 12, color = "black", face = "bold.italic"),
strip.background =element_rect(fill="white"),
axis.text.x = element_text(face="plain", color="black", size= 12, angle = 0),
axis.text.y = element_text(face="plain", color= "black",size= 12, angle = 0),
axis.title.y = element_text(face="plain", color= "black",size= 14),
axis.title.x = element_text(face="plain", color= "black",size= 14),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_text(color="black", size= 12, face= "bold"),
legend.text = element_text(color="black", size= 10, face= "plain"),
legend.position = "top",
panel.border = element_rect(colour = "black", fill = NA, size=0.5),
axis.line = element_line(colour = "black")) +
scale_x_continuous(breaks = c(2012,2013,2014,2015,2016,2017,2018))
o
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
o <- o +
facet_wrap_custom(~species, scales = "free", ncol = 4,nrow=4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(1, 7), breaks=seq(1,7,1))),
scale_override(2, scale_y_continuous(limits  = c(1.2, 2.3), breaks=seq(1.2,2.3,0.25))),
scale_override(3, scale_y_continuous(limits  = c(0.1, 0.8), breaks=seq(0.1,0.8,0.1))),
scale_override(4, scale_y_continuous(limits  = c(1, 11), breaks=seq(1,11,2))),
scale_override(5, scale_y_continuous(limits  = c(7, 11), breaks=seq(7,11,1))),
scale_override(6, scale_y_continuous(limits  = c(0.1, 0.6), breaks=seq(0.1,0.6,0.1))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.3), breaks=seq(0,0.3,0.05))),
scale_override(8, scale_y_continuous(limits  = c(0.25, 2.75), breaks=seq(0.25,2.75,0.5))),
scale_override(9, scale_y_continuous(limits  = c(1, 2), breaks=seq(1,2,0.15))),
scale_override(10, scale_y_continuous(limits  = c(0.1,1.25), breaks=seq(0.1,1.25,0.25))),
scale_override(11, scale_y_continuous(limits  = c(0.3, 3.25), breaks=seq(0.3,3.25,0.5))),
scale_override(12, scale_y_continuous(limits  = c(1.75, 5.5), breaks=seq(1.75,5.5,0.75))),
scale_override(13, scale_y_continuous(limits  = c(0.5, 2), breaks=seq(0.5,2,0.5))),
scale_override(14, scale_y_continuous(limits  = c(0.1, 1), breaks=seq(0.1,1,0.15)))
))
o
ggsave(filename = "time_series_fish_obeserved_vs_expected", plot = o, path = "outputs_results/figures/",
width = 18, device = "png", height = 13, units = 'in', dpi = 600)
ggsave(filename = "time_series_fish_obeserved_vs_expected.png", plot = o, path = "outputs_results/figures/",
width = 18, device = "png", height = 13, units = 'in', dpi = 600)
### Made plot ####
o <- ggplot(data= mdata) +
aes(x = year) +
geom_line(aes(y = biomass), size = 1) +
geom_point(aes(y = observed_biomass),size=1.5) +
facet_wrap( ~ species, scales = "free") +
labs(x="Year", y= expression(Biomass~""~(g~m^{-2}))) +
theme(text=element_text(family="Times New Roman"),
strip.text.x = element_text(size = 14, color = "black", face = "bold.italic"),
strip.background =element_rect(fill="white"),
axis.text.x = element_text(face="plain", color="black", size= 12, angle = 0),
axis.text.y = element_text(face="plain", color= "black",size= 14, angle = 0),
axis.title.y = element_text(face="plain", color= "black",size= 16),
axis.title.x = element_text(face="plain", color= "black",size= 16),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size=0.25),
axis.line = element_line(colour = "black")) +
scale_x_continuous(breaks = c(2012,2013,2014,2015,2016,2017,2018))
o
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
o <- o +
facet_wrap_custom(~species, scales = "free", ncol = 4,nrow=4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(1, 7), breaks=seq(1,7,1))),
scale_override(2, scale_y_continuous(limits  = c(1.2, 2.3), breaks=seq(1.2,2.3,0.25))),
scale_override(3, scale_y_continuous(limits  = c(0.1, 0.8), breaks=seq(0.1,0.8,0.1))),
scale_override(4, scale_y_continuous(limits  = c(1, 11), breaks=seq(1,11,2))),
scale_override(5, scale_y_continuous(limits  = c(7, 11), breaks=seq(7,11,1))),
scale_override(6, scale_y_continuous(limits  = c(0.1, 0.6), breaks=seq(0.1,0.6,0.1))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.3), breaks=seq(0,0.3,0.05))),
scale_override(8, scale_y_continuous(limits  = c(0.25, 2.75), breaks=seq(0.25,2.75,0.5))),
scale_override(9, scale_y_continuous(limits  = c(1, 2), breaks=seq(1,2,0.15))),
scale_override(10, scale_y_continuous(limits  = c(0.1,1.25), breaks=seq(0.1,1.25,0.25))),
scale_override(11, scale_y_continuous(limits  = c(0.3, 3.25), breaks=seq(0.3,3.25,0.5))),
scale_override(12, scale_y_continuous(limits  = c(1.75, 5.5), breaks=seq(1.75,5.5,0.75))),
scale_override(13, scale_y_continuous(limits  = c(0.5, 2), breaks=seq(0.5,2,0.5))),
scale_override(14, scale_y_continuous(limits  = c(0.1, 1), breaks=seq(0.1,1,0.15)))
))
o
ggsave(filename = "time_series_fish_obeserved_vs_expected.png", plot = o, path = "outputs_results/figures/",
width = 18, device = "png", height = 13, units = 'in', dpi = 600)
### Made plot ####
o <- ggplot(data= mdata) +
aes(x = year) +
geom_line(aes(y = biomass), size = 1) +
geom_point(aes(y = observed_biomass),size=1.5) +
facet_wrap( ~ species, scales = "free") +
labs(x="Year", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text=element_text(family = "Times New Roman"),
strip.text.x = element_text(size = 14, color = "black", face = "bold.italic"),
strip.background = element_rect(fill = "white"),
axis.text.x = element_text(face = "plain", color = "black", size = 12, angle = 0),
axis.text.y = element_text(face = "plain", color = "black",size= 14, angle = 0),
axis.title.y = element_text(face = "plain", color = "black",size= 18),
axis.title.x = element_text(face = "plain", color = "black",size = 18),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size=0.25),
axis.line = element_line(colour = "black")) +
scale_x_continuous(breaks = c(2012,2013,2014,2015,2016,2017,2018))
o
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
o <- o +
facet_wrap_custom(~species, scales = "free", ncol = 4,nrow=4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(1, 7), breaks=seq(1,7,1))),
scale_override(2, scale_y_continuous(limits  = c(1.2, 2.3), breaks=seq(1.2,2.3,0.25))),
scale_override(3, scale_y_continuous(limits  = c(0.1, 0.8), breaks=seq(0.1,0.8,0.1))),
scale_override(4, scale_y_continuous(limits  = c(1, 11), breaks=seq(1,11,2))),
scale_override(5, scale_y_continuous(limits  = c(7, 11), breaks=seq(7,11,1))),
scale_override(6, scale_y_continuous(limits  = c(0.1, 0.6), breaks=seq(0.1,0.6,0.1))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.3), breaks=seq(0,0.3,0.05))),
scale_override(8, scale_y_continuous(limits  = c(0.25, 2.75), breaks=seq(0.25,2.75,0.5))),
scale_override(9, scale_y_continuous(limits  = c(1, 2), breaks=seq(1,2,0.15))),
scale_override(10, scale_y_continuous(limits  = c(0.1,1.25), breaks=seq(0.1,1.25,0.25))),
scale_override(11, scale_y_continuous(limits  = c(0.3, 3.25), breaks=seq(0.3,3.25,0.5))),
scale_override(12, scale_y_continuous(limits  = c(1.75, 5.5), breaks=seq(1.75,5.5,0.75))),
scale_override(13, scale_y_continuous(limits  = c(0.5, 2), breaks=seq(0.5,2,0.5))),
scale_override(14, scale_y_continuous(limits  = c(0.1, 1), breaks=seq(0.1,1,0.15)))
))
o
ggsave(filename = "time_series_fish_obeserved_vs_expected.png", plot = o, path = "outputs_results/figures/",
width = 18, device = "png", height = 13, units = 'in', dpi = 600)
#####Read data######
#read data from "processed" folder, scenario 2100 and for NO fish species
d <- read_csv("data/processed/processed_data_figure_box-plot_year_2100_nofish.csv")
#####Read data######
#read data from "processed" folder, scenario 2100 and for NO fish species
d <- read_csv("data/processed/processed_data_figure_box-plot_year_2100_nofish.csv", col_types = cols())
#declare and re-order factor of variables species and scenario
d$species <- factor(d$species,
levels = c("Sea birds","Turtles","Cephalopoda","Panulirus spp.",
"Benthic macroinvertebrates", "Benthic microinvertebrates",
"Siderastrea stellata","Zooplankton",
"Phytoplankton","Digenea simplex","Other algal turf"))
d$scenario <- factor(d$scenario,
levels = c("Status quo", "RCP 2.6", "RCP 4.5", "RCP 8.5"))
#####Data frame with median for each species ######
#Made data-frame with median of the Status quo scenario
d <- d[,-3]
median_statusquo <- d %>%
filter(scenario == "Status quo") %>%
group_by(scenario,year,species) %>%
summarise_all(funs(mean(biomass),median(biomass),sd(biomass),
max(biomass), min(biomass)))
median_statusquo$species <- factor(median_statusquo$species,
levels = c("Sea birds","Turtles","Cephalopoda",
"Panulirus spp.","Benthic macroinvertebrates","Benthic microinvertebrates",
"Siderastrea stellata","Zooplankton",
"Phytoplankton","Digenea simplex","Other algal turf"))
p <- ggplot(d, aes(x = scenario, y = biomass, fill = scenario, facets = species)) +
geom_boxplot(aes(x = as.factor(scenario), y = as.numeric(biomass), fill = scenario),
width = 0.35, fatten = 2.5,  notch = F,
alpha = 0.75, outlier.shape = NA) +
facet_wrap(~ species, scales = "free_y") +
geom_hline(data = median_statusquo, aes(yintercept = median_statusquo$median),
colour = "red", lty = "longdash", lwd = 0.35) +
theme_bw() +
labs(x = "Scenarios", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text = element_text(family = "Times New Roman"),
legend.position = "none",
strip.text.x = element_text(size = 10, color = "black", face = "bold.italic"),
axis.text.x = element_text(size = 10,  color = "black"),
axis.title.x = element_text(size = 15),
axis.text.y  = element_text(size = 11,  color = "black"),
axis.title.y = element_text(size = 15),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
scale_fill_brewer(palette = "RdBu", direction = -1)
p
#Before to run the code below, remember to run the function contained in the script "function_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25)))
))
p
p <- ggplot(d, aes(x = scenario, y = biomass, fill = scenario, facets = species)) +
geom_boxplot(aes(x = as.factor(scenario), y = as.numeric(biomass), fill = scenario),
width = 0.35, fatten = 2.5,  notch = F,
alpha = 0.75, outlier.shape = NA) +
facet_wrap(~ species, scales = "free_y") +
geom_hline(data = median_statusquo, aes(yintercept = median_statusquo$median),
colour = "red", lty = "longdash", lwd = 0.35) +
theme_bw() +
labs(x = "Scenarios", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text = element_text(family = "Times New Roman"),
legend.position = "none",
strip.text.x = element_text(size = 16, color = "black", face = "bold.italic"),
axis.text.x = element_text(size = 14,  color = "black"),
axis.title.x = element_text(size = 18),
axis.text.y  = element_text(size = 14,  color = "black"),
axis.title.y = element_text(size = 20),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
scale_fill_brewer(palette = "RdBu", direction = -1)
p
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25)))
))
p
#### Saving figure ####
ggsave(filename = "boxplot_NOfish_2100.png", plot = p, path = "outputs_results/supp/",
width = 18, device = "png", height = 13, units = 'in', dpi = 400)
p
#### Saving figure ####
ggsave(filename = "boxplot_NOfish_2100.png", plot = p, path = "outputs_results/supp/",
width = 18, device = "png", height = 13, units = 'in', dpi = 400)
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25))),
scale_override(11, scale_y_continuous(limits  = c(400, 900), breaks = seq(400,900,50)))
))
p
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25))),
scale_override(11, scale_y_continuous(limits  = c(400, 900), breaks = seq(400,900,100)))
))
p
#### Saving figure ####
ggsave(filename = "boxplot_NOfish_2100.png", plot = p, path = "outputs_results/supp/",
width = 18, device = "png", height = 13, units = 'in', dpi = 400)
p <- ggplot(d, aes(x = scenario, y = biomass, fill = scenario, facets = species)) +
geom_boxplot(aes(x = as.factor(scenario), y = as.numeric(biomass), fill = scenario),
width = 0.35, fatten = 2.5,  notch = F,
alpha = 0.75, outlier.shape = NA) +
facet_wrap(~ species, scales = "free_y") +
geom_hline(data = median_statusquo, aes(yintercept = median_statusquo$median),
colour = "red", lty = "longdash", lwd = 0.35) +
theme_bw() +
labs(x = "Scenarios", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text = element_text(family = "Times New Roman"),
legend.position = "top",
strip.text.x = element_text(size = 16, color = "black", face = "bold.italic"),
axis.text.x = element_text(size = 14,  color = "black"),
axis.title.x = element_text(size = 18),
axis.text.y  = element_text(size = 14,  color = "black"),
axis.title.y = element_text(size = 20),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
scale_fill_brewer(palette = "RdBu", direction = -1)
p
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25))),
scale_override(11, scale_y_continuous(limits  = c(400, 900), breaks = seq(400,900,100)))
))
p
p <- ggplot(d, aes(x = scenario, y = biomass, fill = scenario, facets = species)) +
geom_boxplot(aes(x = as.factor(scenario), y = as.numeric(biomass), fill = scenario),
width = 0.35, fatten = 2.5,  notch = F,
alpha = 0.75, outlier.shape = NA) +
facet_wrap(~ species, scales = "free_y") +
geom_hline(data = median_statusquo, aes(yintercept = median_statusquo$median),
colour = "red", lty = "longdash", lwd = 0.35) +
theme_bw() +
labs(x = "Scenarios", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text = element_text(family = "Times New Roman"),
legend.position = "top",
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 12, face = "plain"),
legend.key.size = unit(0.85,"line"),
strip.text.x = element_text(size = 16, color = "black", face = "bold.italic"),
axis.text.x = element_text(size = 14,  color = "black"),
axis.title.x = element_text(size = 18),
axis.text.y  = element_text(size = 14,  color = "black"),
axis.title.y = element_text(size = 20),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
scale_fill_brewer(palette = "RdBu", direction = -1)
p
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25))),
scale_override(11, scale_y_continuous(limits  = c(400, 900), breaks = seq(400,900,100)))
))
p
p <- ggplot(d, aes(x = scenario, y = biomass, fill = scenario, facets = species)) +
geom_boxplot(aes(x = as.factor(scenario), y = as.numeric(biomass), fill = scenario),
width = 0.35, fatten = 2.5,  notch = F,
alpha = 0.75, outlier.shape = NA) +
facet_wrap(~ species, scales = "free_y") +
geom_hline(data = median_statusquo, aes(yintercept = median_statusquo$median),
colour = "red", lty = "longdash", lwd = 0.35) +
theme_bw() +
labs(x = "Scenarios", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text = element_text(family = "Times New Roman"),
legend.position = "top",
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 12, face = "plain"),
legend.key.size = unit(1.2,"line"),
strip.text.x = element_text(size = 16, color = "black", face = "bold.italic"),
axis.text.x = element_text(size = 14,  color = "black"),
axis.title.x = element_text(size = 18),
axis.text.y  = element_text(size = 14,  color = "black"),
axis.title.y = element_text(size = 20),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
scale_fill_brewer(palette = "RdBu", direction = -1)
p
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25))),
scale_override(11, scale_y_continuous(limits  = c(400, 900), breaks = seq(400,900,100)))
))
p
p <- ggplot(d, aes(x = scenario, y = biomass, fill = scenario, facets = species)) +
geom_boxplot(aes(x = as.factor(scenario), y = as.numeric(biomass), fill = scenario),
width = 0.35, fatten = 2.5,  notch = F,
alpha = 0.75, outlier.shape = NA) +
facet_wrap(~ species, scales = "free_y") +
geom_hline(data = median_statusquo, aes(yintercept = median_statusquo$median),
colour = "red", lty = "longdash", lwd = 0.35) +
theme_bw() +
labs(x = "Scenarios", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text = element_text(family = "Times New Roman"),
legend.position = "top",
legend.title = element_text(color = "black", size = 14, face = "bold"),
legend.text = element_text(size = 12, face = "plain"),
legend.key.size = unit(1.2,"line"),
strip.text.x = element_text(size = 16, color = "black", face = "bold.italic"),
axis.text.x = element_text(size = 14,  color = "black"),
axis.title.x = element_text(size = 18),
axis.text.y  = element_text(size = 14,  color = "black"),
axis.title.y = element_text(size = 20),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
scale_fill_brewer(palette = "RdBu", direction = -1, name = "Scenarios:")
p
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25))),
scale_override(11, scale_y_continuous(limits  = c(400, 900), breaks = seq(400,900,100)))
))
p
source('~/Dropbox/Atoll_Rocas_project/R/S_Supplementary_figures_boxplot_nofish_2100.R')
p <- ggplot(d, aes(x = scenario, y = biomass, fill = scenario, facets = species)) +
geom_boxplot(aes(x = as.factor(scenario), y = as.numeric(biomass), fill = scenario),
width = 0.35, fatten = 2.5,  notch = F,
alpha = 0.75, outlier.shape = NA) +
facet_wrap(~ species, scales = "free_y") +
geom_hline(data = median_statusquo, aes(yintercept = median_statusquo$median),
colour = "red", lty = "longdash", lwd = 0.35) +
theme_bw() +
labs(x = "Scenarios", y = expression(Biomass~""~(g~m^{-2}))) +
theme(text = element_text(family = "Times New Roman"),
legend.position = "top",
legend.title = element_text(color = "black", size = 18, face = "bold"),
legend.text = element_text(size = 16, face = "plain"),
legend.key.size = unit(1.5,"line"),
strip.text.x = element_text(size = 16, color = "black", face = "bold"),
axis.text.x = element_text(size = 14,  color = "black"),
axis.title.x = element_text(size = 18),
axis.text.y  = element_text(size = 14,  color = "black"),
axis.title.y = element_text(size = 20),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")) +
scale_fill_brewer(palette = "RdBu", direction = -1, name = "Scenarios:")
p
#Before to run the code below, remember to run the function contained in the script "F_modify_facet_scale"
p <- p +
facet_wrap_custom(~species, scales = "free_y", ncol = 4,nrow = 4, scale_overrides = list(
scale_override(1, scale_y_continuous(limits  = c(0, 0.050), breaks = seq(0,.05,0.01))),
scale_override(4, scale_y_continuous(limits  = c(0, 7.5), breaks = seq(0,0.75,1.5))),
scale_override(5, scale_y_continuous(limits  = c(0, 25), breaks = seq(0,25,5))),
scale_override(6, scale_y_continuous(limits  = c(0, 35), breaks = seq(0,35,5))),
scale_override(7, scale_y_continuous(limits  = c(0, 0.95), breaks = seq(0,.95,.15))),
scale_override(8, scale_y_continuous(limits  = c(0.1, 0.9), breaks = seq(0.1,.9,.2))),
scale_override(9, scale_y_continuous(limits  = c(0.025, 0.15), breaks = seq(0.025,.15,0.025))),
scale_override(10, scale_y_continuous(limits  = c(75, 250), breaks = seq(25,250,25))),
scale_override(11, scale_y_continuous(limits  = c(400, 900), breaks = seq(400,900,100)))
))
p
#### Saving figure ####
ggsave(filename = "boxplot_NOfish_2100.png", plot = p, path = "outputs_results/supp/",
width = 18, device = "png", height = 13, units = 'in', dpi = 400)
source('~/Dropbox/Atoll_Rocas_project/R/S_Supplementary_Figure_boxplot_fish_2100.R')
#####Read data######
#Read data from "processed" folder, scenario 2100 and for fish species
d <- read_csv("data/processed/processed_data_figure_box-plot_year_2100_fish.csv",
col_types = cols())
#####Declare and re-order factor of variables species and scenario#####
d$species <- factor(d$species,
levels = c("Negaprion brevirostris","Ginglymostoma cirratum","Lutjanus jocu",
"Cephalopholis fulva", "Carangidae","Acanthurus spp.",
"Stegastes rocasensis","Thalassoma noronhanum",
"Abudefduf saxatilis", "Sparisoma spp.", "Melichthys niger",
"Kyphosus spp.", "Mulloidichthys martinicus",
"Holocentrus adscensionis","Haemulidae", "Cryptobenthic reef fishes"))
d$scenario <- factor(d$scenario,
levels = c("Status quo", "RCP 2.6", "RCP 4.5", "RCP 8.5"))
#####Data frame with median values for each fish species ######
#Made data-frame with median of the Status quo scenario
median_statusquo <- d %>%
filter(scenario == "Status quo") %>%
group_by(scenario,year, species) %>%
summarise_all(funs(mean,median,sd, max, min))
View(median_statusquo)
source('~/Dropbox/Atoll_Rocas_project/R/S_Supplementary_Figure_boxplot_fish_2100.R')
